library(haven)
cleaned_crc_data <- read_dta("~/Documents/My Research/Conferences/SRE June 2023/Data/cleaned_crc_data.dta")
View(cleaned_crc_data)
library(survey)
library(margins)
install.packages('margins')
library(margins)
a <- cleaned_crc_data
# Create survey design object
design <- svydesign(ids = ~1, strata = ~psu, weights = ~weight, data = data)
# Create survey design object
design <- svydesign(ids = ~1, strata = ~psu, weights = ~weight, data = a)
# Create survey design object
design <- svydesign(ids = ~1, strata = ~psu, weights = ~perweight, data = a)
# Fit logistic regression model
model <- svyglm(crc_screening ~ agecat + sex + marital_status + race + usborn + income + educ + smokestatus2, design = design, subset = (age >= 45 & age <= 75 & cancerev != 2 & crc_screening < 2), family = binomial())
mod <- glm(crc_screening ~ agecat, smoking_status, family = 'binomial')
mod <- glm(crc_screening ~ agecat, smoking_status, data = a, family = 'binomial')
mod <- glm(crc_screening ~ agecat, smokestatus2, data = a, family = 'binomial')
summary(a)
summary(mod)
model <- glm(crc_screening ~ agecat, smokestatus2, data = a, family = 'binomial')
summary(model)
# Generate predicted probabilities for each smoking status
margins <- margins(model, variables = "smokestatus2", type = "response")
model <- glm(crc_screening ~ agecat + sex + marital_status + race + usborn + income + educ + smokestatus2, data = a, family = 'binomial')
model <- glm(crc_screening ~ agecat + sex + marital_status + racenew + usborn + income + educ + smokestatus2, data = a, family = 'binomial')
model <- glm(sex ~ agecat + marital_status + racenew + usborn + income + educ + smokestatus2, data = a, family = 'binomial')
model <- glm(usborn ~ agecat + marital_status + racenew  + income + educ + smokestatus2, data = a, family = 'binomial')
summary(model)
# Generate predicted probabilities for each smoking status
margins <- margins(model, variables = "smokestatus2", type = "response")
# Plot predicted probabilities by smoking status
plot(margins, what = "effects", xlab = "Smoking Status", ylab = "Predicted Probability of CRC Screening")
View(margins)
